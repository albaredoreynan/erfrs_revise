h4 SOE REPORT
hr
.row.rfr-index
  =render 'soe_filter'
  .col-md-12.header
    p.text-center 
      b Department of Social Welfare and Development
      br
      |Statement of Expenditures
  .col-md-12
    
.panel.panel-primary
  .table-responsive.scrollable
    table.table.table-hover.sortable
      thead
        tr
          th Item No.
          th Name of Contractor / Supplier / Consultant
          th Contract Number
          th Contract Date
          th Contract Prior Reviewed
          th Control Number
          th Contract Amount (In PHP)
          th Invoice Amount (In PHP)
          th Invoice Date
          th Check Number
          th Check Date
          th Percent Eligibility
          th Amount Eligible for Financing (In PHP)
          th Amount Charged to Designated Account (In USD)
          th Exchange Rate
          th Remarks
      tbody
        - @soe.each_with_index do |soe, index|
          tr
  	       	td= index + 1
  	        td #{soe.subproject.barangay.name}, #{soe.subproject.municipality.name.titleize}
  	        td= trail_id(6, soe.subproject_id)
  	        td= soe.subproject.date_of_mbif
  	        td 
            td
  	        td= number_to_currency soe.subproject.total_grant_amount
  	        td= number_to_currency soe.amount_approve
  	        td= soe.rpmo_date
  	        td= soe.check_number
  	        td= soe.try(:dv_date).try(:to_date)
  	        td 100%
  	        td.dv_amount= number_to_currency soe.subproject.total_dv_amount
  	        td.exchange 
  	        td= text_field_tag :exchange_rate, [], id:"#{soe.id}", class:'exchange_rate'
  	        td= soe.remarks
css:
  .scrollable {
    width: 100%;
    overflow-x: auto;
  }
javascript:
  $(".exchange_rate").blur(function(){
    item_val = parseFloat($(this).val());
    sp_id = $(this).attr("id");
    val = parseFloat($(this).parent().siblings('.dv_amount').html());
    $.ajax({  
      url: "/update_exchange_rate",
      data: {
        exchange_rate: item_val,
        rfrs_id : sp_id
      },
        dataType: "script"
      });
    $(this).parent().siblings('.exchange').html( item_val * val)
  });
            